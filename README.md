## Исправления домашки 6

### Общие изменения

1. **Единый `ModelContainer`**

   * Создан синглтон-контейнер и внедряется во все хранилища через **Dependency Injection**.
   * Исключает рассинхронизацию и избыточные аллокации контейнеров.

2. **Унифицированные SwiftData-хранилища**

   * Вынесен обобщённый `GenericRepository<Model>` с CRUD-методами `fetch / save / update / delete`.
   * Специализированные хранилища (`TransactionsStorage`, `BankAccountsStorage`, …) теперь лишь описывают тип `Model` и, при необходимости, уточняют фильтры/сортировку.
   * Итог — минимум копипаста, единое поведение и одна точка сопровождения.

3. **Автоматический `retry` сетевых запросов**

   * Добавлен декоратор `RetryingNetworkClient` c экспоненциальной задержкой.
   * Повтор выполняется только для **нефатальных** ошибок (временный `URLError`, коды 500…599).
   * Существенно снижает ложные сбои при шатком соединении.

---

## Домашка 7 — SPM модули, графики и зависимости

### SPM-пакет **Utilities/PieChart**

| Файл                 | Содержание                                                   |
| -------------------- | ------------------------------------------------------------ |
| `Package.swift`      | Локальный пакет, target **PieChart**, тип **static library** |
| `Entity.swift`       | `struct Entity { value: Decimal; label: String }`            |
| `PieChartView.swift` | Рисует график в `draw(_:)` через **CoreGraphics / UIKit**    |

*Особенности реализации*

* На графике максимум 6 сегментов: первые 5 элементов + объединённый «**Остальные**».
* Палитра шести цветов задана константами прямо в модуле.
* **★ Анимация**: старый круг вращается → fade out → новый контент fade in, полный оборот 360°.

### Экран «Анализ» (SwiftUI + PieChart)

1. Модуль **PieChart** подключён через SwiftPM и используется внутри экранного вью-моделя.
2. При смене периода операции пере-фетчатся, а график плавно анимируется с использованием указанного ★ сценария.

---

### График истории баланса — экран «Мой счёт»

| Требование                                      | Статус |
| ----------------------------------------------- | :----: |
| **Charts** framework для рендеринга             |    ✅   |
| Последние 30 дней / 24 месяца                   |    ✅   |
| Цвет столбца: красный (–) / зелёный (+)         |    ✅   |
| Скрывать график в режиме Edit                   |    ✅   |
| **★ Tooltip** по долгому тапу                   |    ✅   |
| **★ Segmented Control** День / Месяц + анимация |    ✅   |

---

### Зависимость **Lottie** (SwiftPM)

1. Добавлена в проект через Xcode → **Add Package Dependency**.
2. JSON-анимация из Figma лежит в **Resources**.
3. После статичного LaunchScreen:

   * показывается `LottieAnimationView`,
   * интерфейс приложения появляется только по окончании анимации.
4. **★ Package.swift** для всего проекта: Lottie подключается централизованно, сборка без Xcode-GUI.

---

